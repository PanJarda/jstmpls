function Dispatcher(t,e,i){this.listeners=t||{},this.model=e,this.view=i,this.dispatch("_init")}function main(){var t={clicks:0,error:"",className:"",show:!0,input:"",itemInputs:[],items:[],active:[],completed:[],addClicks:function(){this.clicks++,this.clicks>0&&(this.error="",this.show=!0)},subClicks:function(){this.clicks--,this.clicks<0&&(this.error="Fok You!",this.show=!1)},toggleClass:function(){this.className="red"===this.className?"":"red"},inputChange:function(t){this.input=t.target.value},addItem:function(){this.items.push(this.input),this.itemInputs.push(this.input),this.input=""},removeItem:function(t){var e;console.log("removing item "+t.target.getAttribute("data-index")),this.items.splice(e=1*t.target.getAttribute("data-index"),1),this.itemInputs.splice(e)},editItem:function(t){var e=t.target.getAttribute("data-index");this.items[e]=this.itemInputs[e],this.itemInputs[e]=""},itemInputChange:function(t){var e=t.target.getAttribute("data-index");this.itemInputs[e]=t.target.value},storeModel:function(){console.log("storing");var t=this;window.localStorage&&setTimeout((function(){window.localStorage.setItem("model",JSON.stringify(t))}),0)},loadModel:function(){console.log("loading");var t=JSON.parse(window.localStorage.getItem("model"));t&&Object.assign(this,t)}},e=!1;function i(t){return function(e){return e[t]}}function n(t){return function(e){o.dispatch(t,e)}}window.addEventListener("hashchange",(function(){})),window.addEventListener("storage",(function(){console.log("storage event")}));var s=h("div",{"class":"ahoj"},[h("h1",{"class":i("className"),ev:{click:n("toggleClass")}},"Ahoj"),h("div",e,[h("p",e,i("clicks"))]),h("span",e,i("error")),h("a",{href:"#prdel"},"link1"),h("hr"),h("button",{ev:{mouseup:n("addClick")}},"   +   "),h("i",e," "),h("button",{ev:{mouseup:n("subClick")}},"   -   "),hIf(h("h2",e,"Ahoj"),i("error"),h("span",e,i("error"))),hIf(h("div"),i("show"),h("div",e,[h("div",e,[h("div",e,[h("h1",e,"Ahoj")]),h("div",e,[h("h2",e,"Dalsi ahoj")])])])),hFor(h("ul"),i("items"),(function(){return h("li",e,[h("span",e,i("item")),h("span",e," "),h("input",{value:i("item"),"data-index":i("index"),ev:{change:n("itemInputChange")}}),h("button",{"data-index":i("index"),ev:{click:n("editItem")}},"edit"),h("button",{"data-index":i("index"),ev:{mouseup:n("removeItem")}}," X ")])})),h("input",{value:i("input"),ev:{change:n("inputChange")}}),h("button",{ev:{mouseup:n("addItem")}},"add Item")]),o=new Dispatcher({_init:["loadModel"],_before:[],addClick:["addClicks"],subClick:["subClicks"],toggleClass:["toggleClass"],inputChange:["inputChange"],addItem:["addItem"],removeItem:["removeItem"],itemInputChange:["itemInputChange"],editItem:["editItem"],loadModel:["loadModel"],_after:["storeModel"]},t,s),a=document.getElementById("app");a.innerHTML="",a.appendChild(s.ref)}function route(t){console.log("hashchange")}Dispatcher.prototype.addEventListener=function(t,e){(this.listeners=this.listeners[t]||[]).push(e)},Dispatcher.prototype.dispatch=function(t,e){"_before"!==t&&"_after"!==t&&"_init"!==t&&this.dispatch("_before",e);var i=this.listeners[t];if(i)for(var n=i.length;n--;)this.model[i[n]](e);if("_before"!==t&&"_after"!==t&&"_init"!==t&&this.dispatch("_after",e),"_after"===t||"_init"===t){var s=this;window.requestAnimationFrame((function(){s.view.update(s.model)}))}},window.addEventListener?window.addEventListener("load",main,!1):window.attachEvent&&(document.onreadystatechange=new function(){"complete"!==document.readyState&&"interactive"!==document.readyState||main()}),window.addEventListener("popstate",(function(t){console.log("popstate")})),window.addEventListener("hashchange",route);